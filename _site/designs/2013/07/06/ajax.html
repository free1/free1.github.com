<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
    <meta name="author" content="Free" />
    <meta name="generator" content="Jekyll 1.0.2" />
    <meta name="description" content="Ajax" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    
    <link rel="stylesheet" type="text/css" href="/css/post.css" media="all" />

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

    <script type="text/javascript" src="/js/compatible.js"></script>

</head>
	<body>
		<div id="Previous">
			<a href="http://free1.github.com/"> <-Home </a>
		</div>

		<div id="Title">
	    	<h1>ajax使用</h1>
	    	<p><b>06 Jul 2013</b>, by <b>Free</b></p>
		</div>

		<div id="Post">
	    	<article id="articlePost">
	        	<h2>使用ajax与服务器通信的的步骤</h2>

<ul>
<li>创建一个XMLHttpRequest对象</li>
<li>创建url,data,用xmlHttpRequest.open(&quot;GET&quot;,url,false)初始化 HTTP 请求参数。</li>
<li>通过 xmlHttpRequest.send()发送,(如果是get请求则填入null即可,如果是post请求则填入实际的数据)</li>
<li>服务器端接收 ajax的请求,做相应处理(操作数据库)，然后返回结果</li>
<li>客户端通过xmlHttpRequest的属性 reponseText , responseXML 取的数据，然后就完成局部刷新当前页面任务</li>
</ul>

<p>使用 ajax完成用户名的验证事例代码(php):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;用户注册&lt;/title&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;/&gt;
&lt;script type=&quot;text/javascript&quot;&gt;

    //创建ajax引擎
    function getXmlHttpObject(){

        var xmlHttpRequest;
        //不同的浏览器获取对象xmlhttprequest 对象方法不一样
        if(window.ActiveXObject){

            xmlHttpRequest=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);

        }else{

            xmlHttpRequest=new XMLHttpRequest();
        }

        return xmlHttpRequest;

    }
    var myXmlHttpRequest=&quot;&quot;;

    //验证用户名是否存在
    function checkName(){

        myXmlHttpRequest=getXmlHttpObject();

        //怎么判断创建ok
        if(myXmlHttpRequest){

            //通过myXmlHttpRequest对象发送请求到服务器的某个页面
            //第一个参数表示请求的方式, &quot;get&quot; / &quot;post&quot;
            //第二个参数指定url,对哪个页面发出ajax请求(本质仍然是http请求)
            //第三个参数表示 true表示使用异步机制,如果false表示不使用异步
            var url=&quot;/ajax/registerProcess.php?mytime=&quot;+new  Date()+&quot;&amp;username=&quot;+$(&quot;username&quot;).value;
            //打开请求.
            myXmlHttpRequest.open(&quot;get&quot;,url,true);
            // myXmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded&quot;);  使用POST方法时必须使用此函数
            //指定回调函数.chuli是函数名
            myXmlHttpRequest.onreadystatechange=chuli;

            //真的发送请求,如果是get请求则填入 null即可
            //如果是post请求，则填入实际的数据
            myXmlHttpRequest.send(null); 


        }
    }

    //回调函数
    function chuli(){

        //window.alert(&quot;处理函数被调回&quot;+myXmlHttpRequest.readyState);
        //我要取出从registerPro.php页面返回的数据
        if(myXmlHttpRequest.readyState==4){

            //取出值,根据返回信息的格式定.text
            //window.alert(&quot;服务器返回&quot;+myXmlHttpRequest.responseText);

            $(&#39;myres&#39;).value=myXmlHttpRequest.responseText;
        }
    }

    //这里我们写一个函数
    function $(id){
        return document.getElementById(id);
    }
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action=&quot;???&quot; method=&quot;post&quot;&gt;
    用户名字:&lt;input type=&quot;text&quot;  onkeyup=&quot;checkName();&quot;  name=&quot;username1&quot; id=&quot;username&quot;&gt;&lt;input type=&quot;button&quot; onclick=&quot;checkName();&quot;  value=&quot;验证用户名&quot;&gt;
    &lt;input style=&quot;border-width: 0;color: red&quot; type=&quot;text&quot; id=&quot;myres&quot;&gt;
    &lt;br/&gt;
    用户密码:&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
    电子邮件:&lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;用户注册&quot;&gt;
    &lt;/form&gt;
     &lt;form action=&quot;???&quot; method=&quot;post&quot;&gt;
    用户名字:&lt;input type=&quot;text&quot; name=&quot;username2&quot; &gt;

    &lt;br/&gt;
    用户密码:&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
    电子邮件:&lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;用户注册&quot;&gt;
    &lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;


&lt;?php

    //这里两句话很重要,第一讲话告诉浏览器返回的数据是xml格式
    header(&quot;Content-Type: text/xml;charset=utf-8&quot;);
    //告诉浏览器不要缓存数据
    header(&quot;Cache-Control: no-cache&quot;);

    //从客户端接收数据
    $username=$_GET[&#39;username&#39;];

    // 与数据库关联时链接数据库
    if($username==&quot;shunping&quot;){
        echo &quot;用户名不可以用&quot;;//注意，这里数据是返回给请求的页面.
    }else{
        echo &quot;用户名可以用&quot;;
    }

?&gt;  
</code></pre></div>
	    	</article>

	    	
				<div style="height: 64px"></div>
    		
		</div>
		
	</body>
</html>


 
   
       