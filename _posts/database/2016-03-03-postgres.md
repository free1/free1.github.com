---
layout: post
title: postgresql基础
category: database
description: postgresql
disqus: false
---

## [初始化postgresql](http://stackoverflow.com/questions/14948406/how-to-start-postgres-server)
## [备份与恢复](https://dreamer-yzy.github.io/2015/01/13/-%E7%BF%BB%E8%AF%91-PostgreSQL-9-0-%E5%A4%87%E4%BB%BD-%E6%81%A2%E5%A4%8D/)
## [mac安装postgres](http://exponential.io/blog/2015/02/21/install-postgresql-on-mac-os-x-via-brew/)


## 基本命令

* 进入数据库: `psql -U db_user -d db_name -h 127.0.0.1 -p 5432`
* 创建数据库用户: `sudo -u postgres createuser --superuser db_user`
* 创建数据库: `sudo -u postgres createdb -O db_user db_name`
* 所有数据库: `\l`
* 退出数据库: `\q`
* 连接其他数据库: `\c [database_name]`
* 当前数据库所有表格: `\d`
* 查看某个数据库:  `\d dbname`
* 某一张表格的结构: `\d [table_name]`
* 列出所有用户: `\du`
* 当前数据库和连接的信息: `\conninfo`
* 设置密码: `\password`
* 备份数据: `pg_dump`
* 导入数据: `psql  -d  postgres  -f whistler_production_20161017 -U postgres -W`
* 以数据文件夹启动: `postgres -D /Users/free/pg_data > /opt/postgresql/log/pg_server.log 2>&1 &`
* 删除数据库:       

```
SELECT 
    pg_terminate_backend(pid) 
FROM 
    pg_stat_activity 
WHERE 
    -- don't kill my own connection!
    pid <> pg_backend_pid()
    -- don't kill the connections to other databases
    AND datname = 'database_name'
    ;
REVOKE CONNECT ON DATABASE dbname FROM PUBLIC, username;

dropdb -U postgres db_name
```
