---
layout: post
title: 区块链基础
category: blockchain
description: blockchain
disqus: false
---

## 基础常识
* 比特币地址使用Base58生成
* 区块链技术的模型是由自下而上的数据层、网络层、共识层、激励层、合约层和应用层组成
* Merkle Patricia Tree(简称MPT树，实际上是一种trie前缀树, 默克尔树)是以太坊中的一种加密认证的数据结构，可以用来存储所有的(key，value)对
* 未花费的输出(UTXO): 比特币有，以太坊只有账户系统
* 共识算法: POW(Proof of Work工作证明), POS(Proof of Stake股权证明), DPOS(Delegated Proof of Stake委任权益证明)
* 拜占庭问题: 拜占庭问题更为广泛, 讨论的是允许存在少数节点作恶(消息可能被伪造)场景下的一致性达成问题, 拜占庭算法讨论的是最坏情况下的保障
* 椭圆曲线算法: 比特币使用了secp256k1标准所定义的一条特殊的椭圆曲线和一系列数学常数
* 随机漫步(random walk)算法, 泊松分布
* CAP原则: 在一个分布式系统中, Consistency(一致性),  Availability(可用性), Partition tolerance(分区容错性)，三者不可得兼
* [闪电网络](http://www.8btc.com/ln-rn-corda): 在链下实现真正的点对点微支付交易
* 隔离见证: 把签名部分从块中移出
* 简单交易验证(SPV): 比特币使用默克尔树(Merkle Tree)的数据结构验证
* 安全: 51%攻击，双花攻击，重放攻击
* 微支付通道
* 侧链


## [常见共识算法](https://bitshuo.com/topic/58ad85b108d6a0f32a5bc045)
* POW：Proof of Work，工作证明
  比特币在Block的生成过程中使用了POW机制，一个符合要求的Block Hash由N个前导零构成，零的个数取决于网络的难度值。要得到合理的Block Hash需要经过大量尝试计算，计算时间取决于机器的哈希运算速度。当某个节点提供出一个合理的Block Hash值，说明该节点确实经过了大量的尝试计算，当然，并不能得出计算次数的绝对值，因为寻找合理hash是一个概率事件。当节点拥有占全网n%的算力时，该节点即有n/100的概率找到Block Hash。

* POS：Proof of Stake，股权证明
  POS：也称股权证明，类似于财产储存在银行，这种模式会根据你持有数字货币的量和时间，分配给你相应的利息。 
简单来说，就是一个根据你持有货币的量和时间，给你发利息的一个制度，在股权证明POS模式下，有一个名词叫币龄，每个币每天产生1币龄，比如你持有100个币，总共持有了30天，那么，此时你的币龄就为3000，这个时候，如果你发现了一个POS区块，你的币龄就会被清空为0。你每被清空365币龄，你将会从区块中获得0.05个币的利息(假定利息可理解为年利率5%)，那么在这个案例中，利息 = 3000 * 5% / 365 = 0.41个币，这下就很有意思了，持币有利息。

* DPOS：Delegated Proof of Stake，委任权益证明
  比特股的DPoS机制，中文名叫做股份授权证明机制（又称受托人机制），它的原理是让每一个持有比特股的人进行投票，由此产生101位代表 , 我们可以将其理解为101个超级节点或者矿池，而这101个超级节点彼此的权利是完全相等的。从某种角度来看，DPOS有点像是议会制度或人民代表大会制度。如果代表不能履行他们的职责（当轮到他们时，没能生成区块），他们会被除名，网络会选出新的超级节点来取代他们。DPOS的出现最主要还是因为矿机的产生，大量的算力在不了解也不关心比特币的人身上


## 简单交易验证(SPV)
* SPV客户端持续从连接的节点上获取新区块的头部，并加入到本地区块链中
* SPV客户端从节点上获取到一个跟自己相关的交易hash值
* SPV客户端从节点上下载包含该交易hash的完整交易merkle树
* 重新计算并验证merkle root和头部中的是否一致，若一致则验证通过
* Bloom filter从节点上获取和自己相关的交易hash


## 比特币地址生成
* 助记词生成: 创建一个128到256位的随机序列（熵）。提出SHA256哈希前几位（熵长/ 32），就可以创造一个随机序列的校验和。将校验和添加到随机序列的末尾。将序列划分为包含11位的不同部分。将每个包含11位部分的值与一个已经预先定义2048个单词的字典做对应。生成的有顺序的单词组就是助记码。
* 种子生成: PBKDF2密钥延伸函数的第一个参数是从步骤6生成的助记符。PBKDF2密钥延伸函数的第二个参数是盐。 由字符串常数“助记词”与可选的用户提供的密码字符串连接组成。PBKDF2使用HMAC-SHA512算法，使用2048次哈希来延伸助记符和盐参数，产生一个512位的值作为其最终输出。 这个512位的值就是种子。
* 私钥(prikey)的生成: 随机数或者通过随机数seed生成
* 公钥(pubkey)的生成: pubkey=椭圆曲线函数(prikey,p,q)，不可逆
* 比特币地址的生成: Address=BASE58(RIPEMD160(SHA256(pubkey)))，不可逆


## 闪电网络
* 序列到期可撤销合约RSMC(Revocable Sequence Maturity Contract): 解决了通道中币单向流动问题, 交易双方之间存在一个“微支付通道”（资金池）。双方都预存一部分资金到“微支付通道”里，之后每次交易，就对交易后的资金分配方案共同进行确认，同时签字作废旧的版本。当需要提现时，将最终交易结果写到区块链网络中，被最终确认。可以看到，只有在提现时候才需要通过区块链。
* 哈希时间锁定合约HTLC(Hashed Timelock Contract): 解决了币跨节点传递的问题


## [RPC远程调用](https://waylau.com/remote-procedure-calls/)
* RPC 是指计算机 A 上的进程，调用另外一台计算机 B 上的进程，其中 A 上的调用进程被挂起，而 B 上的被调用进程开始执行，当值返回给 A 时，A 进程继续执行。调用方可以通过使用参数将信息传送给被调用方，而后可以通过传回的结果得到信息


## [比特币区块链的数据结构解析](http://8btc.com/article-1915-1.html)


## [比特币难度计算](https://zhuanlan.zhihu.com/p/32739785)


## [区块链核心技术演进之路 – 挖矿演进](http://www.8btc.com/blockchain-tech-mining)



